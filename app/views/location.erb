<html>

<head>
  <title>Where is
    <%= person.name %>?</title>
  <style>
    html,
    body,
    iframe {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    .wrapper {
      height: 100%;
      width: 100%;
      position: absolute;
      top: 0;
      color: #333333;
      text-align: center;
      font-size: 30pt;
      pointer-events: none;
    }

    .wrapper div {
      padding: .8em;
      margin-top: 20%;
      background-color: rgba(255, 255, 255, 0.7);
      pointer-events: auto;
    }

    .location,
    .tz,
    #local-time {
      color: #932192;
    }
  </style>

  <script type="text/javascript">
    function updateLocalTime() {
      var date = new Date();
      var offset_minutes = date.getTimezoneOffset() + <%= location.time_zone_offset %>;
      date.setTime(date.getTime() + offset_minutes * 60 * 1000);
      element = document.getElementById("local-time");
      if (element) { element.innerHTML = date.toLocaleTimeString([], {hour: "numeric", minute: "numeric"}); }
    }
    window.setInterval(updateLocalTime, 15)
  </script>
</head>

<body>
  <div class='wrapper'>
    <div>
      <%= person.name %> is probably in: <span class='location'><%= location.pretty_name %></span>,
        <br /> and
        <%= person.pronoun %> current UTC Offset is: <span class='tz'><%= location.time_zone_offset_hours %>:<%= location.time_zone_offset_minutes.to_s.rjust(2, '0') %></span>
        <br />
        where the local time is <span id="local-time" />
    </div>
  </div>
  <iframe frameborder="0" style="border:0;width:100%;height:100%" src="https://www.google.com/maps/embed/v1/place?key=<%= tokens[:GOOGLE_MAPS]  %>
                      &q=<%= location.pretty_name.gsub(' ','+') %>" allowfullscreen>
  </iframe>
</body>

</html>
